Loop.each({mosaic:function(t,a,o,r,i){if(arguments.length<=1){var n=this.canvas;return this.mosaic(0,0,n.width,n.width,arguments[0])}("number"!=typeof i||i<=0)&&(i=10);for(var e=this.getImageData(t,a,o,r),h=e.data,f=Math.ceil(o/i),u=Math.ceil(r/i),c=0;c<f;c++)for(var d=c*i,s=0;s<u;s++){var v,M,g,m,p,l=s*i,D=0,w=0,y=0,C=0,I=0;for(v=0;v<i;v++)if(g=d+v,!(g>o))for(M=0;M<i;M++)m=l+M,m>r||(p=4*(g*o+m),D+=h[p],w+=h[p+1],y+=h[p+2],C+=h[p+3],I++);for(D=Math.round(D/I),w=Math.round(w/I),y=Math.round(y/I),C=Math.round(C/I),v=0;v<i;v++)if(g=d+v,!(g>o))for(M=0;M<i;M++)m=l+M,m>r||(p=4*(g*o+m),h[p]=D,h[p+1]=w,h[p+2]=y,h[p+3]=C)}this.putImageData(e,t,a)}},function(t,a){CanvasRenderingContext2D.prototype[a]=t});