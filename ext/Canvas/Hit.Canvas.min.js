Loop.each({mosaic:function(t,a,h,i,r){if(arguments.length<=1){var e=this.canvas;return this.mosaic(0,0,e.width,e.height,arguments[0])}("number"!=typeof r||r<=0)&&(r=10);for(var n=this.getImageData(t,a,h,i),o=n.data,s=Math.ceil(h/r),f=Math.ceil(i/r),g=0;g<s;g++)for(var u=g*r,l=0;l<f;l++){var c,d,v,m,p,M=l*r,b=0,D=0,w=0,x=0,I=0;for(c=0;c<r;c++)if(v=u+c,!(v>=h))for(d=0;d<r;d++)m=M+d,m>=i||(p=4*(m*h+v),b+=o[p],D+=o[p+1],w+=o[p+2],x+=o[p+3],I++);for(b=Math.round(b/I),D=Math.round(D/I),w=Math.round(w/I),x=Math.round(x/I),c=0;c<r;c++)if(v=u+c,!(v>=h))for(d=0;d<r;d++)m=M+d,m>=i||(p=4*(m*h+v),o[p]=b,o[p+1]=D,o[p+2]=w,o[p+3]=x)}this.putImageData(n,t,a)},getPixels:function(t,a,h,i){if(0===arguments.length){var r=this.canvas;return this.getPixels(0,0,r.width,r.height)}for(var e=this.getImageData(t,a,h,i).data,n=[],o=0;o<e.length;o+=4)n.push({r:e[o],g:e[o+1],b:e[o+2],a:e[o+3]});return n},clearAll:function(t){" number"!=typeof t&&(t=1);var a=this.canvas;this.clearRect(0,0,a.width*t,a.height*t)},fillAll:function(t){" number"!=typeof t&&(t=1);var a=this.canvas;this.fillRect(0,0,a.width*t,a.height*t)},mapPixels:function(t,a,h,i,r){if(1===arguments.length){var e=this.canvas;return this.mapPixels(0,0,e.width,e.height,arguments[0])}for(var n=this.getImageData(t,a,h,i),o=n.data,s=0;s<o.length;s+=4){var f={r:o[s],g:o[s+1],b:o[s+2],a:o[s+3]};r(f,s%h,Math.floor(s/h)),o[s]=Math.round(f.r)||0,o[s+1]=Math.round(f.g)||0,o[s+2]=Math.round(f.b)||0,o[s+3]=Math.round(f.a)||0}this.putImageData(n,t,a)}},function(t,a){CanvasRenderingContext2D.prototype[a]=t});