Extension.define("Beeper",[],function(){"use strict";var t=window;if("webkitAudioContext"in t&&!("AudioContext"in t)&&(t.AudioContext=t.webkitAudioContext),!("AudioContext"in t))return{supported:!1};var e=new AudioContext,n=new Constructor(function(){this.oscillatorNode=e.createOscillator(),this.gainNode=e.createGain(),this._hasStarted=!1},{init:function(){return n.concat([this.oscillatorNode,this.gainNode,e.destination]),this},start:function(){return this._hasStarted=!0,this.oscillatorNode.start(),this},stop:function(){return this.oscillatorNode.stop(),this},setGain:function(t){return this.gainNode.gain.setValueAtTime(t,e.currentTime),this},fadeInGain:function(t,n){return this.setGain(0),this.gainNode.gain.linearRampToValueAtTime(t,e.currentTime+n/1e3),this},fadeOutGain:function(t){return this.gainNode.gain.linearRampToValueAtTime(0,e.currentTime+t/1e3),this},setFreq:function(t){return this.oscillatorNode.frequency.setValueAtTime(t,e.currentTime),this},setType:function(t){return this.oscillatorNode.type=t,this},fadeIn:function(t,e){if(!this._hasStarted)try{this.start()}catch(t){}return this.fadeInGain(t,e),this},fadeOut:function(t){this.fadeOutGain(t);return this}});return n.context=e,n.concat=function(t){return t.reduce(function(t,e){return t.connect(e),e}),this},n.play=function(t){if(!(t instanceof Object))throw new Error("No config!");var e=new n;if("dest"in t?e.oscillatorNode.connect(e.gainNode).connect(t.dest):e.init(),"type"in t&&e.setType(t.type),"freq"in t&&e.setFreq(t.freq),"gain"in t){var i=t.gain;"fadeIn"in t?e.fadeInGain(i,t.fadeIn):e.setGain(i)}if("dur"in t){var r=t.dur;if("fadeOut"in t){var a=t.fadeOut;setTimeout(function(){e.fadeOutGain(a)},r-a)}setTimeout(function(){e.stop()},r)}return e.start(),e},n.beep=function(t,e){return arguments.length>1?n.play({freq:t,dur:e}):n.play({freq:t})},n.BeepSequence=new Constructor(function(t,e){e=e||{},this.isRunning=!1,this.beeper=new n,this.beeper.init(),e.type&&this.beeper.setType(e.type),this.fadeIn=e.fadeIn||0,this.fadeOut=e.fadeOut||0,this.gain="gain"in e?e.gain:1,this.beepArr=t||[],this.gap=e.gap||0},{start:function(){if(this.isRunning)return this;var t=this.beeper;t.setGain(0);var n=0;if(Loop.each(this.beepArr,function(i,r){1&r?n+=i:t.oscillatorNode.frequency.setValueAtTime(i,e.currentTime+n/1e3)}),this.fadeIn>0?t.fadeInGain(this.gain,this.fadeIn):t.setGain(this.gain),this.fadeOut>0){var i=this.fadeOut;setTimeout(function(){t.fadeOutGain(i)},n-i)}return t.start(),this},stop:function(){return this.isRunning&&(this.isRunning=!1,this.beeper.stop()),this}}),n.beepArr=function(t,e){if(!(t instanceof Array))throw new Error("Illegal array!");e=e||{};var i=e.base;i>0&&(t=Loop.map(t,function(t,e){return 1&e?t*i:t}));var r=new n.BeepSequence(t,e);return r.start(),r},n.SCALE={L1:131,L2:147,L3:165,L4:175,L5:196,L6:220,L7:247,M1:262,M2:294,M3:330,M4:349,M5:392,M6:440,M7:494,H1:523,H2:587,H3:659,H4:698,H5:784,H6:880,H7:988},n.supported=!0,n});