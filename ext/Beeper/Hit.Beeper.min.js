Extension.define("Beeper",[],function(){"use strict";var t=window;if("webkitAudioContext"in t&&!("AudioContext"in t)&&(t.AudioContext=t.webkitAudioContext),!("AudioContext"in t))return{supported:!1};var e=new AudioContext,i=new Constructor(function(){this.oscillatorNode=e.createOscillator(),this.gainNode=e.createGain(),this._hasStarted=!1},{init:function(){return i.concat([this.oscillatorNode,this.gainNode,e.destination]),this},start:function(){return this._hasStarted=!0,this.oscillatorNode.start(),this},stop:function(){return this.oscillatorNode.stop(),this},setGain:function(t){return this.gainNode.gain.setValueAtTime(t,e.currentTime),this},fadeInGain:function(t,i){return this.setGain(0),this.gainNode.gain.linearRampToValueAtTime(t,e.currentTime+i/1e3),this},fadeOutGain:function(t){return this.gainNode.gain.linearRampToValueAtTime(0,e.currentTime+t/1e3),this},setFreq:function(t){return this.oscillatorNode.frequency.setValueAtTime(t,e.currentTime),this},setType:function(t){return this.oscillatorNode.type=t,this},fadeIn:function(t,e){if(!this._hasStarted)try{this.start()}catch(t){}return this.fadeInGain(t,e),this},fadeOut:function(t){this.fadeOutGain(t);return this}});return i.context=e,i.concat=function(t){return t.reduce(function(t,e){return t.connect(e),e}),this},i.play=function(t){if(!(t instanceof Object))throw new Error("No config!");var e=new i;if("dest"in t?e.oscillatorNode.connect(e.gainNode).connect(t.dest):e.init(),"type"in t&&e.setType(t.type),"freq"in t&&e.setFreq(t.freq),"gain"in t){var n=t.gain;"fadeIn"in t?e.fadeInGain(n,t.fadeIn):e.setGain(n)}if("dur"in t){var r=t.dur;if("fadeOut"in t){var a=t.fadeOut;setTimeout(function(){e.fadeOutGain(a)},r-a)}setTimeout(function(){e.stop()},r)}return e.start(),e},i.beep=function(t,e){return arguments.length>1?i.play({freq:t,dur:e}):i.play({freq:t})},i.BeepSequence=new Constructor(function(t,e){e=e||{},this.isRunning=!1,this.beeper=new i,this.beeper.init(),e.type&&this.beeper.setType(e.type),this.fadeIn=e.fadeIn||0,this.fadeOut=e.fadeOut||0,this.gain="gain"in e?e.gain:1,this.beepArr=t||[],this.gap=e.gap||0},{start:function(){if(this.isRunning)return this;this.isRunning=!0;var t=this.beeper,i=this.gap;t.setGain(0);var n=-i;if(Loop.each(this.beepArr,function(r,a){1&a?(i&&(n+=i,t.gainNode.gain.setValueAtTime(1,e.currentTime+n/1e3)),n+=r,i&&t.gainNode.gain.setValueAtTime(0,e.currentTime+n/1e3)):t.oscillatorNode.frequency.setValueAtTime(r,e.currentTime+n/1e3)}),this.fadeIn>0?t.fadeInGain(this.gain,this.fadeIn):t.setGain(this.gain),this.fadeOut>0){var r=this.fadeOut;setTimeout(function(){t.fadeOutGain(r)},n-r)}return t.start(),this},stop:function(){return this.isRunning&&(this.isRunning=!1,this.beeper.stop()),this}}),i.beepArr=function(t,e){if(!(t instanceof Array))throw new Error("Illegal array!");e=e||{};var n=e.base;n>0&&(t=Loop.map(t,function(t,e){return 1&e?t*n:t}));var r=new i.BeepSequence(t,e);return r.start(),r},i.SCALE={L1:262,L1S:277,L2:294,L2S:311,L3:330,L4:349,L4S:370,L5:392,L5S:415,L6:440,L6S:466,L7:494,M1:523,M1S:554,M2:587,M2S:622,M3:659,M4:698,M4S:740,M5:784,M5S:831,M6:880,M6S:932,M7:988,H1:1046,H1S:1109,H2:1175,H2S:1245,H3:1318,H4:1397,H4S:1480,H5:1568,H5S:1661,H6:1760,H6S:1865,H7:1976},i.supported=!0,i});