"use strict";var Constructor=function(t,n){return t.prototype=n||{},t},Loop={each:function(t,n,e){if(t instanceof Object)if("number"==typeof t.length)for(var i=0;i<t.length;i++)n.call(e,t[i],i,t);else for(var r in t)n.call(e,t[r],r,t)},map:function(t,n,e){if(t instanceof Object){var i="number"==typeof t.length,r=i?[]:{};return Loop.each(t,function(t,e,o){var s=n.call(this,t,e,o);i?r.push(s):r[e]=s},e),r}},filter:function(t,n,e){if(t instanceof Object){var i="number"==typeof t.length,r=i?[]:{};return Loop.each(t,function(t,e,o){var s=n.call(this,t,e,o);s&&(i?r.push(t):r[e]=t)},e),r}},find:function(t,n,e){try{Loop.each(t,function(t,e,i){if(n.call(this,t,e,i))throw t},e)}catch(t){return t}},findIndex:function(t,n,e){try{Loop.each(t,function(t,e,i){if(n.call(this,t,e,i))throw e},e)}catch(t){return t}return-1},some:function(t,n,e){try{Loop.each(t,function(t,e,i){if(n.call(this,t,e,i))throw!0},e)}catch(t){return t}return!1},every:function(t,n,e){try{Loop.each(t,function(t,e,i){if(!n.call(this,t,e,i))throw!1},e)}catch(t){return t}return!0}},Compare={equal:function(t,n){return t===n||isNaN(t)&&isNaN(n)}};Loop.each({after:function(t){var n=this;return function(){var e=n.apply(this,arguments);return t.apply(this,arguments),e}},before:function(t){var n=this;return function(){return t.apply(this,arguments),n.apply(this,arguments)}},single:function(){var t=void 0,n=this;return function(){return void 0===t&&(t={},Loop.each(n.prototype,function(n,e){t[e]=n}),n.apply(t,arguments)),t}}},function(t,n){Function.prototype[n]=t});var ObjectPool=new Constructor(function(t){Object.defineProperty(this,"constructor",{value:t||Object}),this._pool=[]},{get:function(){return this._pool.length?this._pool.shift():new this.constructor},recycle:function(t){if(!(t instanceof constructor))throw new Error("Please input an instance of the constructor!");return this._pool.push(t),this._pool.length},count:function(){return this._pool.length},prepare:function(t){if("number"!=typeof t)return void console.warn('"count" must be a number!');for(;this._pool.length<t;)this._pool.push(new this.constructor);return this},drop:function(){var t=Loop.map(this._pool,function(t){return t});return this._pool=[],t}}),Sequence=new Constructor(function(t,n){this._callbacks=[],this._delays=[],this._offset=0,n&&void 0!==t&&this.next(t,n)},{next:function(t,n){return this._callbacks.push(n),this._delays.push(t+this._offset),this._offset+=t,this},execute:function(){return Loop.map(this._callbacks,function(t,n){return setTimeout(t,this._delays[n])},this)}});Sequence.create=function(t,n){return new Sequence(t,n)},"from"in Array||(Array.from=function(t){return Loop.map(t,function(t){return t})}),"of"in Array||(Array.of=function(){return Array.from(arguments)}),"includes"in Array.prototype||(Array.prototype.includes=function(t){return Loop.find(this,function(n){return Compare.equal(n,t)})}),"Map"in window||(window.Map=function(t){var n=[],e=[];Object.defineProperty(this,"size",{get:function(){return n.length}}),this.clear=function(){n=[],e=[]},this.delete=function(t){return Loop.find(n,function(i,r){if(Compare.equal(t,i))return n.splice(r,1),e.splice(r,1),!0})},this.forEach=function(t,i){Loop.each(n,function(n,r){t.call(i,e[r],n,this)},this)},this.get=function(t){try{return this.forEach(function(n,e){if(Compare.equal(t,e))throw n})}catch(t){return t}},this.has=function(t){return n.includes(t)},this.set=function(t,i){return this.delete(t),n.push(t),e.push(i),this},t&&Loop.each(t,function(t){this.set(t[0],t[1])})}),"Set"in window||(window.Set=function(t){var n=[];Object.defineProperty(this,"size",{get:function(){return n.length}}),this.clear=function(){n=[]},this.delete=function(t){return Loop.find(n,function(e,i){if(Compare.equal(t,e))return n.splice(i,1),!0})},this.forEach=function(t,e){Loop.each(n,function(n,i){t.call(e,n,n,this)},this)},this.has=function(t){return n.includes(t)},this.set=function(t){return this.delete(t),n.push(t),this},t&&Loop.each(t,this.set)}),"Promise"in window||(window.Promise=function(t){var n=[],e=[],i=[],r=null,o="pending";this.then=function(t,i){return i&&("rejected"===o?setTimeout(i,0,r):e.push(i)),t?(new Promise)(function(e,i){n.push(function(n){if(!(t instanceof Function))return e(t);try{var r=t(n);r&&r.then?r.then(e,i):e(r)}catch(t){i(t)}})}):this},this.catch=function(t){return i.push(error),this},t&&setTimeout(function(){t(function(t){o="resolved",r=t;for(var e=0;e<n.length;e++)n[e](r)},function(t){o="rejected",r=t;for(var n=e.length>0?e:i,s=0;s<n.length;s++)n[s](r)})},0)}),"done"in Promise.prototype||(Promise.prototype.done=function(t,n){this.then(t,n).catch(function(t){throw t})}),"reject"in Promise||(Promise.reject=function(t){return new Promise(function(n,e){e(t)})}),"resolve"in Promise||(Promise.resolve=function(t){return new Promise(function(n,e){n(t)})}),"setImmediate"in window||(window.setImmediate=function(t){var n=Array.from(arguments);return n.splice(1,0,0),setTimeout.apply(window,n)},window.clearImmediate=window.clearTimeout),!1 in window&&(window.requestAnimationFrame=function(t){return setTimeout(t,15)},window.cancelAnimationFrame=window.clearTimeout),"preventDefault"in Event.prototype||(Event.prototype.preventDefault=function(){this.returnValue=!1}),"stopPropagation"in Event.prototype||(Event.prototype.stopPropagation=function(){this.bubbles=!1});var ChainNode=new Constructor(function(t){this.next=null,this.prev=null,this.value=t},{insertAfter:function(t){return null==t?(this.next&&(this.next.prev=null,this.next=null),this):ChainNode.check(t)?(this.next=t,t.prev&&(t.prev.next=null),t.prev=this,t):void console.warn("Illegal node")},insertBefore:function(t){return null==t?(this.prev&&(this.prev.next=null,this.prev=null),this):ChainNode.check(t)?(this.prev=t,t.next&&(t.next.prev=null),t.next=this,t):void console.warn("Illegal node")},remove:function(){this.prev&&(this.prev.next=null,this.prev=null),this.next&&(this.next.prev=null,this.next=null)}});ChainNode.check=function(t){return node instanceof Object&&"next"in node&&"prev"in node};var Chain=new Constructor(function(t){this.head=null,this.tail=null,this.pointer=null,t&&Loop.each(t,function(t){this.append(new ChainNode(t))},this)},{count:function(){if(!this.head)return 0;for(var t=1,n=Chain.maxLen,e=this.head;e!==this.tail;)if(t++,e=e.next,t>n)return console.warn("This chain may be too long to count."),n;return t},append:function(t){return ChainNode.check(t)?(this.tail?(t.prev=this.tail,this.tail.next=t,this.tail=t):this.pointer=this.tail=this.head=t,this):void console.warn("Illegal node")},toArray:function(t){if(!this.head)return[];for(var n=Chain.maxLen,e=this.head,i=[e];e!==this.tail;)if(e=e.next,i.push(t!==!1?new ChainNode(e):e),i.length>n)return console.warn("This chain may be too long to convert."),i;return i},reset:function(){return this.pointer=this.head},next:function(){return this.pointer&&(this.pointer=this.pointer.next),this.pointer},abandon:function(){return this.tail&&(this.tail.prev.next=null,this.tail=this.tail.prev),this}});Chain.maxLen=99999;var Agency=new Constructor(function(){this._listeners={},this._caches={},this.cache=!1},{trigger:function(t,n){return n=n||[],n instanceof Object&&"length"in n||(n=[n]),t in this._listeners?(this._listeners[t].forEach(function(t){t.apply(null,n)}),!0):(this.cache&&(t in this._caches||(this._caches[t]=[]),this._caches[t].push(n)),!1)},newTrigger:function(t){return function(n){self.trigger(t,n)}.bind(this)},listen:function(t,n){return this.cache&&t in this._caches?(this._caches[t].forEach(function(t){n.apply(null,t)}),delete this._caches[t]):(void 0===this._listeners[t]&&(this._listeners[t]=[]),this._listeners[t].push(n)),this},listenOnce:function(t,n){var e=this,i=function(){n.apply(this,arguments),e.ignore(t,i)};return this.listen(t,i)},ignore:function(t,n){var e=this._listeners[t];if(void 0!==e)for(var i=0;i<e.length;i++)if(e[i]===n)return!0;return!1},ignoreType:function(t){return void 0!==this._listeners[t]&&(this._listeners[t]=void 0)},ignoreAll:function(){var t=!!this._listeners||!!this._caches;return this._listeners={},this._caches={},t},bind:function(t){try{var n=this;return Loop.each(["listen","listenOnce","ignore","ignoreAll","ignoreType"],function(e){t[e]=function(){return n[e].apply(n,arguments),this}}),!0}catch(t){return!1}}});Agency.bind=function(t){return t._agency=new Agency,t._agency.bind(t),t},Loop.each({mid:function(t,n){t=Array.from(t),n!==!1&&(t=t.sort(function(t,n){return t-n}));var e=t.length;return 1&e&&(e-=1),t[e/2]},med:function(t,n,e){return Math.mid([t,n,e])},mix:function(t,n,e){return t*e+n*(1-e)},cut:function(t,n){if("number"!=typeof t)return NaN;n>=0||(n=0),t+="";var e=t.indexOf(".");return e!==-1&&(t=t.split(""),t.splice(e+n+1),t=t.join("")),t-0},distance:function(t,n,e,i){return Math.sqrt(Math.pow(t-e,2)+Math.pow(n-i,2))},distance_p:function(t,n){return Math.distance(t.x,t.y,n.x,n.y)},distance3d:function(t,n,e,i,r,o){return Math.sqrt(Math.pow(t-i,2)+Math.pow(n-r,2)+Math.pow(e-o,2))},distance3d_p:function(t,n){return Math.distance3d(t.x,t.y,t.z,n.x,n.y,n.z)}},function(t,n){Math[n]=t});var DOM={create:function(t){try{var n=t.match(/^[\w\-]+/)[0],e=document.createElement(n),i=null,r=null;return t=t.slice(n.length),i=t.indexOf("{"),i!==-1&&(e.html(t.slice(i+1,t.lastIndexOf("}"))),t=t.slice(0,i)),i=t.indexOf("."),i!==-1&&(r=t.split("."),t=r.shift(),Loop.each(r,e.addClass,e)),t.match(/^#/)&&(e.id=t.slice(1)),e}catch(t){return null}},select:function(t,n){try{return Array.from(document.querySelectorAll(t))}catch(t){if(n===!1)throw t;return null}},trigger:function(t,n,e,i){var r=document.createEvent("HTMLEvents");return r.initEvent(n,i,e),!!t.dispatchEvent&&t.dispatchEvent(r)},ready:function(t,n){return document.on("ready",t,n)},load:function(t,n){return window.listen("load",t,n)},CustomEvents:{ready:function(t,n,e){/interactive|complete|loaded/.test(document.readyState)&&(document._DOMReady_=!0),document._DOMReady_&&setTimeout(n),t.listen("DOMContentLoaded",function(t){document._DOMReady_||(document._DOMReady_=!0,n())},e),document.listen("readystatechange",function(t){document._DOMReady_||/interactive|loaded|complete/.test(document.readyState)&&(document._DOMReady_=!0,n())},e),window.listen("load",function(){document._DOMReady_||(document._DOMReady_=!0,n())})},change:function(t,n,e){var i=NaN;t.listen("blur",function(){t.value!==i&&(n(),i=t.value)},e)},pointerdown:function(t,n,e){t.listen("mousedown",function(t){t.x=t.clientX,t.y=t.clientY,n.call(this,t)},e),t.listen("touchstart",function(t){t.x=t.touches[0].clientX,t.y=t.touches[0].clientY,n.call(this,t)},e)},pointermove:function(t,n,e){t.listen("mousemove",function(t){t.x=t.clientX,t.y=t.clientY,n.call(this,t)},e),t.listen("touchmove",function(t){t.x=t.touches[0].clientX,t.y=t.touches[0].clientY,n.call(this,t)},e)},pointerup:function(t,n,e){t.listen("mouseup",function(t){t.x=t.clientX,t.y=t.clientY,n.call(this,t)},e),t.listen("touchend",function(t){t.x=t.touches[0].clientX,t.y=t.touches[0].clientY,n.call(this,t)},e)}}},Ani={Frame:new Constructor(function(){var t=!1,n=null,e=null,i=null,r=new Agency,o=function(){if(t&&"number"==typeof this.fps){var s=+new Date;n&&(e=s-n),n=s,r.trigger("update",+new Date);var u=+new Date;i=u-s,setTimeout(this.usingRAF?function(){requestAnimationFrame(o)}:o,Math.max(0,1e3/this.fps-i))}}.bind(this);this.fps=40,this.usingRAF=!0,this.start=function(){return t=!0,r.trigger("start",+new Date),setTimeout(o),this},this.stop=function(){return t=!1,r.trigger("stop",+new Date),this},Object.defineProperties(this,{isRunning:{get:function(){return t}},lastUpdateTime:{get:function(){return n}},lastUpdateGap:{get:function(){return e}},lastFrameDuration:{get:function(){return i}}}),Loop.each(["listen","listenOnce","ignore","ignoreType","ignoreAll"],function(t){this[t]=function(){return r[t].apply(r,arguments),this}},this)},{update:function(){return this.listen("update",this.stop).start()},setFps:function(t){return this.fps=t,this}}),create:function(t,n){var e=new Ani.Frame;return e.fps=t,e.listen("start",n).start()},cubicAccuracy:.006,cubic:function(t,n,e,i){var r=Ani.cubicAccuracy;t>1?t=1:t<0&&(t=0),e>1?e=1:e<0&&(e=0);var o=function(r){for(var o=[0,t,e,1],s=[0,n,i,1],u=3;u>0;){for(var c=[],a=[],h=0;h<u;h++)c[h]=o[h]+(o[h+1]-o[h])*r,a[h]=s[h]+(s[h+1]-s[h])*r;o=c,s=a,u--}return{x:o[0],y:s[0]}},s=function(t,n,e){var i=(n+e)/2,u=o(i);if(Math.abs(u.x-t)<=r)return u.y;try{return u.x>t?s(t,n,i):s(t,i,e)}catch(t){return console.warn("Failed to calculate more accurately:"+t),u.y}};return function(t){return s(t,0,1)}},linear:function(t){return t},steps:function(t,n){n=n||!1;var e=1/t;return n?function(t){return Math.ceil(t/e)*e}:function(t){return Math.floor(t/e)*e}}};Loop.each({ease:Ani.cubic(.25,1,.25,1),easeIn:Ani.cubic(.42,0,1,1),easeOut:Ani.cubic(0,0,.58,1),easeInOut:Ani.cubic(.42,0,.58,1)},function(t,n){Ani[n]=t}),Element.prototype.appendTo=function(t){return t.appendChild(this),this},Element.prototype.attr=function(t,n){return 1===arguments.length?this.getAttribute(t):(this.setAttribute(t,n),this)},Element.prototype.css=function(t,n){return 1===arguments.length?this.style[t]:(this.style[t]=n,this)},Element.prototype.toAbbr=function(){var t=this.id,n=Array.from(this.classList).join(".");return this.tagName.toLowerCase()+(t?"#"+t:"")+(n?"."+n:"")},Element.prototype.addClass=function(t){var n=this.attr("class");return n?(n=n.split(/\s+/),n.indexOf(t)===-1&&(n.push(t),this.attr("class",n.join(" ")))):this.attr("class",t),this},Element.prototype.delClass=function(t){var n=(this.attr("class")||"").split(" ");return n=Loop.filter(n,function(n){return n!==t}),this.attr("class",n.join(" ")),this},Element.prototype.disable=function(t){return this.disabled=void 0===t?t:!this.disabled,this},Element.prototype.html=function(t){return 0===arguments.length?this.innerHTML:(this.innerHTML=t,this)},Element.prototype.hide=function(){return this.css("display","none")},Element.prototype.show=function(t){return t=t||"block",this.css("display",t)},Element.prototype.remove=function(){return this.parentNode.removeChild(this)},Element.prototype.generation=function(){return this.parentNode.children},Element.prototype.prev=function(){var t=this.parentNode.children,n=Array.from(t).indexOf(this);return 0===n?null:t[n-1]},Element.prototype.next=function(){var t=this.parentNode.children,n=Array.from(t).indexOf(this);return n===t.length-1?null:t[n+1]},Element.prototype.scroll=function(t,n){return void 0===n&&(n=t),this.scrollLeft+=t,this.scrollTop+=n,this},Element.prototype.insertTo=function(t,n){return n.insertBefore(this,n.children[t]),this},Element.prototype.insertChild=function(t,n){return this.insertBefore(n,this.children[t]),this},Element.prototype.isSeen=function(t){"number"!=typeof t&&(t=0);var n=Math.max(document.documentElement.scrollTop,document.body.scrollTop),e=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),i=this.offsetTop,r=this.offsetLeft;return n+window.innerHeight+t>=i&&n<=i+this.getBoundingClientRect().height+t&&e+window.innerWidth+t>=r&&e<=r+this.getBoundingClientRect().width+t},Element.prototype.val=function(t){return 0===arguments.length?this.value:(this.value=""+t,DOM.trigger(this,"input"),this)},Element.prototype.ani=function(t){var n=this,e=new Ani.Frame,i=t.from,r=t.to,o=t.dur,s="unit"in t?t.unit:"px",u=t.fps,c=t.style,a=/^-?\d*\.?\d+/g,h=t.fn,l=t.transferer||!1,f=+new Date;return void 0==i&&(i=this.style[c]||0),"string"==typeof i&&(i=i.match(a)[0]-0),"string"==typeof r&&(r=r.match(a)[0],r-=0),"number"!=typeof o&&(o=1e3),"number"!=typeof u&&(u=40),h instanceof Function||(h=Ani.linear),e.fps=50,e.listen("update",function(t){var e=Math.med(i,i+(r-i)*h((t-f)/o),r)+s;l&&(e=l(e)),n.style[c]=e}),e.listen("stop",function(){n.style[c]=r+s}),setTimeout(e.stop,o),e.ele=function(){return n},e.start()},Element.prototype.fadeOut=function(t){var n=this;return t=t||{},this.ani({style:"opacity",from:t.from||1,to:0,unit:"",fps:t.fps||32,dur:t.dur||1e3,fn:t.fn}).listen("stop",function(){n.hide()})},Element.prototype.fadeIn=function(t){var n=this;return t=t||{},n.show(t.display||"block"),this.ani({style:"opacity",from:t.from||0,to:1,unit:"",fps:t.fps||32,dur:t.dur||1e3,fn:t.fn})},Loop.each([Element,Document,Window],function(t){t.prototype.listen=void 0===t.prototype.addEventListener?function(t,n){return this["on"+t]=n,this}:function(t,n,e){return this.addEventListener(t,n,e),this},t.prototype.ignore=void 0===t.prototype.removeEventListener?function(t,n){return t="on"+t,this[t]===n&&(this[t]=null),this}:function(t,n,e){return this.removeEventListener(t,n,e),this},Loop.each({on:function(t,n,e){return t in DOM.CustomEvents?DOM.CustomEvents[t](this,n,e):this.listen(t,n,e),this},trigger:function(t,n,e){return DOM.trigger(this,t,n,e)}},function(n,e){t.prototype[e]=n})});var Ajax={Result:new Constructor(function(t,n,e){Object.defineProperties(this,{e:{value:t},request:{value:t.target},response:{get:function(){return t.target.response}},startTime:{value:n},finishTime:{value:e},status:{value:t.target.status}})},{json:function(){var t=this;return new Promise(function(n,e){try{n(JSON.parse(t.response))}catch(t){e(t)}})}}),Config:new Constructor(function(t){this.method="GET",this.url=t||null,this.data="",this.async=!0,this.user="",this.password="",this.beforeSend=null,this.transferData=!0,this.transferResult=!0,this.params={}},{set:function(t){return Loop.each(t,function(t,n){n in this&&(this[n]=t)},this),this}}),send:function(t){if(window.XMLHttpRequest&&t&&t instanceof Object&&t.url)return new Promise(function(n,e){t=(new Ajax.Config).set(t);try{var i=new XMLHttpRequest;"{}"!==JSON.stringify(t.params)&&(t.url=Ajax.joinParams(t.url,t.params)),i.open(t.method,t.url,t.async===!0,t.user,t.password),i.onabort=e,i.onerror=e,i.ontimeout=e,i.onload=function(o){200==i.status?n(t.transferResult===!1?o:new Ajax.Result(o,r,+new Date)):e(o)},t.beforeSend&&t.beforeSend(i),i.send(t.transferData===!1?t.data:JSON.stringify(t.data));var r=+new Date}catch(t){e(t)}})},parseURL:function(t){t=t||document.URL;var n={},e=-1,i=document.createElement("a");i.href=t||document.URL,n.src=i.href,n.protocol=i.protocol.slice(0,-1),n.hash=i.hash.slice(1),n.file=i.pathname,"/"!==n.file[0]&&"\\"!==n.file[0]||(n.file=n.file.slice(1)),e=n.file.lastIndexOf("/"),e!==-1&&(n.file=n.file.slice(e+1)),n.port=i.port,n.host=i.host,e=n.host.lastIndexOf(":"),e!==-1&&(n.host=n.host.split(""),n.host.splice(e),n.host=n.host.join("")),n.get_a=function(){return i};var r=i.search.slice(1).split("&");n.args={};for(var o;o=r.shift();)o=o.split("="),n.args[o[0]]=o[1];return e=n.file.lastIndexOf("."),n.ext=e===-1?"":n.file.slice(e+1).toLowerCase(),n},joinParams:function(t,n){if(0===arguments.length)return null;1===arguments.length&&(n=t,t=""),t+=t.indexOf("?")===-1?"?":"&";var e=0;return Loop.each(n,function(n,i){e++>0&&(t+="&"),t+=encodeURI(i)+"="+encodeURI(n)}),t}},Script={includePath:"",loadOne:function(t,n,e){if("string"==typeof t)return new Promise(function(i,r){try{n=n||"text/javascript",e!==!1&&(t=Script.includePath+t);var o=document.createElement("script");o.src=t,o.onload=i,o.onabort=r,o.onerror=r,document.head.appendChild(o)}catch(t){r(t)}})},loadSome:function(t,n,e,i){if(n===!0){var r=Promise.resolve();return Loop.each(t,function(t){r=r.then(function(){return Script.loadOne(t,e,i)})}),r}return Promise.all(Loop.map(t,function(t){return Script.loadOne(t,e,i)}))},loadGroup:function(t,n,e){var i=Promise.resolve();return Loop.each(t,function(t){i=i.then(function(){return Script.loadSome(t,!1,n,e)})}),i}},Extension=function(){var t={},n=[],e=function(){var t=[];n.forEach(function(n){n()||t.push(n)}),n=t},i={};return i.export=function(n,i){return!(n in t)&&(1===arguments.length&&(i=n),t[n]=i,e(),!0)},i.import=function(n){return n in t?t[n]:null},i.define=function(t,n,e){return i.need(n,function(){i.export(t,e.apply(this,arguments))})},i.need=function(e,i){for(var r=new Array(e.length),o=0;o<e.length;o++){if(!(e[o]in t))return n.push(function(){for(var n=0;n<e.length;n++){if(!(e[n]in t))return!1;r[n]=t[e[n]]}return setImmediate.apply(window,[i].concat(r)),!0}),!1;r[o]=t[e[o]]}return i.apply(null,r),!0},i}();